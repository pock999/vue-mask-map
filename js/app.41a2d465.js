(function(t){function e(e){for(var a,r,s=e[0],c=e[1],p=e[2],u=0,d=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&d.push(n[r][0]),n[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(d.length)d.shift()();return i.push.apply(i,p||[]),o()}function o(){for(var t,e=0;e<i.length;e++){for(var o=i[e],a=!0,s=1;s<o.length;s++){var c=o[s];0!==n[c]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=o[0]))}return t}var a={},n={app:0},i=[];function r(e){if(a[e])return a[e].exports;var o=a[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=a,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(o,a,function(e){return t[e]}.bind(null,a));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/vue-mask-map/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var p=0;p<s.length;p++)e(s[p]);var l=c;i.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";var a=o("85ec"),n=o.n(a);n.a},"56d7":function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var a,n=o("2b0e"),i=o("bc3a"),r=o.n(i),s=o("a7fe"),c=o.n(s),p=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("loading",{attrs:{loader:"bars",active:t.isLoading,"can-cancel":!0,"is-full-page":!1},on:{"update:active":function(e){t.isLoading=e}}}),o("div",{staticClass:"container-fluid"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-4"},[o("div",{staticClass:"form-group"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.county,expression:"county"}],staticClass:"form-control form-control-lg",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.county=e.target.multiple?o:o[0]}}},[o("option",{attrs:{value:""}},[t._v("--請選擇縣市--")]),t._l(t.countyList,(function(e,a){return o("option",{key:a,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])}))],2),o("select",{directives:[{name:"model",rawName:"v-model",value:t.town,expression:"town"}],staticClass:"form-control mt-2",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.town=e.target.multiple?o:o[0]}}},[o("option",{attrs:{value:""}},[t._v("--請選擇行政區--")]),t._l(t.townList,(function(e,a){return o("option",{key:a,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])}))],2)]),o("div",{staticClass:"list-group d-none d-md-block"},t._l(t.showList,(function(e,a){return o("a",{key:a,staticClass:"list-group-item list-group-item-action flex-column\n          align-items-start"},[o("div",{staticClass:"d-flex w-100 justify-content-between"},[o("h5",{staticClass:"mb-1"},[t._v(t._s(e.properties.name))]),o("small",[t._v(t._s(e.properties.town)+" "+t._s(e.properties.cunli))])]),o("p",{staticClass:"mb-1"},[o("a",{attrs:{href:"https://www.google.com.tw/maps/dir//"+e.properties.address}},[t._v(" "+t._s(e.properties.address)+" ")])]),o("p",{staticClass:"mb-1"},[t._v("資料更新時間:"+t._s(e.properties.updated))]),o("ul",{staticStyle:{"padding-left":"0"}},[o("li",{staticStyle:{"list-style-type":"none","text-align":"left"}},[t._v("大人口罩: "+t._s(e.properties.mask_adult))]),o("li",{staticStyle:{"list-style-type":"none","text-align":"left"}},[t._v("小孩口罩: "+t._s(e.properties.mask_child))])]),o("small",[t._v(t._s(e.properties.phone))])])})),0)]),o("div",{staticClass:"col-md-8 map-container"},[o("MapView",{attrs:{"mask-data":t.apiData,"pento-locate":t.penToLocation},on:{updateShowList:t.updateShowList,initList:t.initList}})],1)])])],1)},l=[],u=(o("4160"),o("caad"),o("d3b7"),o("6062"),o("2532"),o("3ca3"),o("159b"),o("ddb0"),o("2909")),d=o("9062"),h=o.n(d),f=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"map"}})},m=[],w=(o("99af"),o("d81d"),o("b0c0"),o("e11e")),g=o.n(w),v=(o("2573"),g.a.markerClusterGroup()),y=new g.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),_=new g.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),b=new g.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),L={name:"MapView",props:["maskData","pentoLocate"],data:function(){return{centerCoord:[],parseData:[],showData:[]}},methods:{updateListData:function(){this.$emit("updateShowList",this.showData)},initData:function(){this.$emit("initList",this.showData)},getLocation:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.showPosition,this.showError):(this.showError(),alert("定位可能出了一點小狀況"))},showPosition:function(t){var e=this;return new Promise((function(o){a=g.a.map("map").setView([t.coords.latitude,t.coords.longitude],10),g.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'<a href="https://www.openstreetmap.org/">OSM</a>'}).addTo(a),e.centerCoord=[t.coords.latitude,t.coords.longitude],o("OK")})).then((function(t){console.log(t),e.importData(),e.initData()}))},showError:function(){var t=this;return new Promise((function(e){t.centerCoord=[23.635915,121.063619],a=g.a.map("map").setView([23.635915,120.863619],10),g.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'<a href="https://www.openstreetmap.org/">OSM</a>'}).addTo(a),e("not OK")})).then((function(e){console.log(e),t.importData(),t.initData()}))},importData:function(){var t=this;console.log("import data"),this.maskData.forEach((function(e){t.parseData.push(JSON.parse(JSON.stringify(e)))})),this.parseData.forEach((function(t){var e,o=t.geometry.coordinates;e=0===t.properties.mask_adult&&0===t.properties.mask_child?g.a.marker([o[1],o[0]],{icon:b}):t.properties.mask_adult<10&&t.properties.mask_child<10?g.a.marker([o[1],o[0]],{icon:y}):g.a.marker([o[1],o[0]],{icon:_}),e.bindPopup("<h2><a href='https://www.google.com.tw/maps/dir//".concat(t.properties.address,"'>").concat(t.properties.name,"</a></h2><h4>大人口罩:").concat(t.properties.mask_adult,"</h4><h4>小孩口罩").concat(t.properties.mask_child,"</h4>")).openPopup(),v.addLayer(e)})),a.addLayer(v),this.showData=this.parseData,this.updateListData()},mapPanTo:function(t){a.panTo(t)}},beforeMount:function(){var t=this;return new Promise((function(e){t.getLocation(),e()})).then((function(){t.importData(),t.initData()}))},watch:{maskData:function(t){"undefined"!==typeof t[0]&&(this.importData(),this.initData())},pentoLocate:function(t){this.mapPanTo(t)}}},k=L,D=(o("8ff2"),o("2877")),S=Object(D["a"])(k,f,m,!1,null,null,null),x=S.exports,j={name:"App",components:{MapView:x,loading:h.a},data:function(){return{apiURL:"https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json",apiData:[],initData:[],showList:[],countyList:["基隆市","臺北市","新北市","連江縣","宜蘭縣","新竹市","新竹縣","桃園市","苗栗縣","臺中市","彰化縣","南投縣","嘉義市","嘉義縣","雲林縣","臺南市","高雄市","南海島","澎湖縣","金門縣","屏東縣","臺東縣","花蓮縣"],townList:[],county:"",town:"",penToLocation:[],isLoading:!0}},watch:{county:function(t){var e=[];this.initData.forEach((function(o){o.properties.county===t&&e.push(o.properties.town)})),this.townList=Object(u["a"])(new Set(e))},town:function(t){var e=this;console.log(t);var o=[];try{this.initData.forEach((function(a){a.properties.town===t&&(e.penToLocation=[a.geometry.coordinates[1],a.geometry.coordinates[0]],console.log(e.penToLocation)),a.properties.address.includes(e.county)&&a.properties.town===t&&o.push(a)})),this.updateShowList(o)}catch(a){console.log("錯誤")}}},methods:{loadingAPI:function(){var t=this;this.$http.get(this.apiURL).then((function(e){t.apiData=e.data.features})).then((function(){setTimeout((function(){t.isLoading=!1}),5e3)})).catch((function(t){console.log(t),alert("不好意思ajax出了問題!!!")}))},updateShowList:function(t){this.showList=t},initList:function(t){this.initData=t}},created:function(){this.loadingAPI()}},P=j,O=(o("034f"),Object(D["a"])(P,p,l,!1,null,null,null)),C=O.exports;n["a"].use(c.a,r.a),n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(C)}}).$mount("#app")},"85ec":function(t,e,o){},"8ff2":function(t,e,o){"use strict";var a=o("f56c"),n=o.n(a);n.a},f56c:function(t,e,o){}});
//# sourceMappingURL=app.41a2d465.js.map